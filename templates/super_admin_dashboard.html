<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate">
Â  Â  <meta http-equiv="Pragma" content="no-cache">
Â  Â  <meta http-equiv="Expires" content="0">
Â  Â 
Â  Â  <title>Super Admin Dashboard</title>
Â  Â  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
Â  Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  padding-top: 20px;
Â  Â  Â  Â  Â  Â  padding-bottom: 70px; /* Space for the fixed footer */
Â  Â  Â  Â  Â  Â  background-color: #f4f7f6;
Â  Â  Â  Â  }
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 1200px;
Â  Â  Â  Â  Â  Â  position: relative; /* Needed for absolute positioning of super-admin-link */
Â  Â  Â  Â  }
Â  Â  Â  Â  .card {
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 6px rgba(0,0,0,.08);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- HEADER (DASHBOARD VIEW) --- */
Â  Â  Â  Â  .dashboard-header {
Â  Â  Â  Â  Â  Â  /* FIXED: Replaced tri-color with Saffron/Light-Grey */
Â  Â  Â  Â  Â  Â  background: linear-gradient(to bottom, #FF9933 50%, #F9F9F9 50%);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  padding: 15px 20px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  border: 1px solid #000080;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Ashoka Chakra IMG/SVG CSS removed, but we keep the other header H1 styling */
Â  Â  Â  Â  .dashboard-header h1 {
Â  Â  Â  Â  Â  Â  color: #000080;
Â  Â  Â  Â  Â  Â  font-weight: 800;
Â  Â  Â  Â  Â  Â  font-size: 2em;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  display: inline-flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- SIVA STYLING (RETAINED) --- */
Â  Â  Â  Â  .siva-text {
Â  Â  Â  Â  Â  Â  font-weight: 900;
Â  Â  Â  Â  Â  Â  font-size: 1.6em;
Â  Â  Â  Â  Â  Â  background: linear-gradient(270deg, gold, orange, yellow, green, blue, indigo, violet, gold);
Â  Â  Â  Â  Â  Â  background-size: 400% 100%;
Â  Â  Â  Â  Â  Â  -webkit-background-clip: text;
Â  Â  Â  Â  Â  Â  -webkit-text-fill-color: transparent;
Â  Â  Â  Â  Â  Â  text-shadow: 2px 2px 6px rgba(0,0,0,0.8);
Â  Â  Â  Â  Â  Â  margin-left: 10px;
Â  Â  Â  Â  Â  Â  animation: rainbow 6s ease infinite;
Â  Â  Â  Â  Â  Â  white-space: nowrap;
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes rainbow {
Â  Â  Â  Â  Â  Â  0% { background-position: 0% 50%; }
Â  Â  Â  Â  Â  Â  50% { background-position: 100% 50%; }
Â  Â  Â  Â  Â  Â  100% { background-position: 0% 50%; }
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes spin {
Â  Â  Â  Â  Â  Â  100% { transform: rotate(360deg); }
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- LOGIN CARD --- */
Â  Â  Â  Â  /* Removed .login-card .ashoka-chakra CSS */
Â  Â  Â  Â  .login-card {
Â  Â  Â  Â  Â  Â  max-width: 400px;
Â  Â  Â  Â  Â  Â  margin: 100px auto;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 16px rgba(0,0,0,.15);
Â  Â  Â  Â  }

Â  Â  Â  Â  .login-card .card-header {
Â  Â  Â  Â  Â  Â  /* FIXED: Replaced tri-color with Saffron/Light-Grey */
Â  Â  Â  Â  Â  Â  background: linear-gradient(to bottom, #FF9933 50%, #F9F9F9 50%);
Â  Â  Â  Â  Â  Â  color: #000080;
Â  Â  Â  Â  Â  Â  border-top-left-radius: 12px;
Â  Â  Â  Â  Â  Â  border-top-right-radius: 12px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 20px 0;
Â  Â  Â  Â  Â  Â  border-bottom: 5px solid #000080;
Â  Â  Â  Â  }

Â  Â  Â  Â  .login-card .btn-primary {
Â  Â  Â  Â  Â  Â  background-color: #000080;
Â  Â  Â  Â  Â  Â  border-color: #000080;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }

Â  Â  Â  Â  .login-card .btn-primary:hover {
Â  Â  Â  Â  Â  Â  background-color: #000055;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- TABLE STYLING --- */
Â  Â  Â  Â  .table-responsive-scroll {
Â  Â  Â  Â  Â  Â  max-height: 400px;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  border: 1px solid #ddd;
Â  Â  Â  Â  }

Â  Â  Â  Â  .invite-link-input.copy-success {
Â  Â  Â  Â  Â  Â  border: 2px solid #28a745 !important;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 5px #28a745;
Â  Â  Â  Â  Â  Â  transition: all 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  /* Master Erase specific styling */
Â  Â  Â  Â  .master-erase-card .card-header {
Â  Â  Â  Â  Â  Â  background-color: #dc3545 !important;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  /* NEW STYLE: Table for Master Erase (and generally for scrolling) */
Â  Â  Â  Â  .table-responsive {
Â  Â  Â  Â  Â  Â  max-height: 400px; /* Limit height for long lists */
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  /* NEW STYLE: for the discreet Super Admin link */
Â  Â  Â  Â  .super-admin-link {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 10px;
Â  Â  Â  Â  Â  Â  right: 20px;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  text-decoration: none;
Â  Â  Â  Â  Â  Â  padding: 5px 10px;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.7);
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s;
Â  Â  Â  Â  Â  Â  z-index: 100;
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  Â  }
Â  Â  Â  Â  .super-admin-link:hover {
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.9);
Â  Â  Â  Â  Â  Â  color: #000;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  </style>
</head>
<body>
Â  Â  
Â  Â  <div class="container">

Â  Â  Â  Â  {% if not is_authenticated %}
Â  Â  Â  Â  <a href="{{ url_for('super_admin_dashboard') }}" class="super-admin-link">Super Admin Login</a>
Â  Â  Â  Â  {% endif %}

Â  Â  Â  Â  {% with messages = get_flashed_messages(with_categories=true) %}
Â  Â  Â  Â  {% if messages %}
Â  Â  Â  Â  {% for category, message in messages %}
Â  Â  Â  Â  <div class="alert alert-{{ 'danger' if category == 'error' else ('success' if category == 'success' else 'info') }}">
Â  Â  Â  Â  Â  Â  {{ message|safe }}
Â  Â  Â  Â  </div>
Â  Â  Â  Â  {% endfor %}
Â  Â  Â  Â  {% endif %}
Â  Â  Â  Â  {% endwith %}

Â  Â  Â  Â  {% if not is_authenticated %}
Â  Â  Â  Â  <div class="login-card card">
Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  System Access Required</h4>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-center text-muted">Enter password for administrator.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <form method="POST" action="{{ url_for('super_admin_dashboard') }}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="password" class="font-weight-bold">System Password</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="password" class="form-control" id="password" name="password" required autofocus>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-primary btn-block mt-4">Verify and Proceed</button>
Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  {% else %}
Â  Â  Â  Â  <div class="dashboard-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h1>Super Admin Dashboard <span class="siva-text">SIVA</span></h1>
Â  Â  Â  Â  Â  Â  <a href="{{ url_for('logout') }}" class="btn btn-sm btn-danger ml-3">Logout</a>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card border-success">
Â  Â  Â  Â  Â  Â  <div class="card-header bg-success text-white">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>1ï¸âƒ£ Generate New Society Invitation</h4>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  <p>Click below to generate a new unique, time-bound invitation link (valid for 14 days).</p>
Â  Â  Â  Â  Â  Â  Â  Â  <form method="POST" action="{{ url_for('super_admin_dashboard') }}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="hidden" name="action" value="create_invite">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-success btn-lg">Generate Invitation</button>
Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card border-primary">
Â  Â  Â  Â  Â  Â  <div class="card-header bg-primary text-white">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>2ï¸âƒ£ Pending Registration Requests ğŸ“¨</h4>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  {% if pending_requests %}
Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-responsive-scroll">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="table table-striped table-hover table-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead class="thead-dark sticky-top">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>ID</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Society Name</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Email</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Mobile</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Submitted</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Action</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {% for req in pending_requests %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ req.id }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ req.society_name }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ req.email }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ req.mobile_number }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ req.submitted_at.strftime('%Y-%m-%d %H:%M') }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form method="POST" action="{{ url_for('approve_request', request_id=req.id) }}" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onsubmit="return confirm('APPROVE {{ req.society_name }}? This generates an invite link.');" style="display:inline;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-sm btn-success">Approve & Invite</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form method="POST" action="{{ url_for('reject_request', request_id=req.id) }}" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onsubmit="return confirm('REJECT {{ req.society_name }}?');" style="display:inline;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-sm btn-danger">Reject</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {% endfor %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  {% else %}
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-muted">No pending registration requests at this time.</p>
Â  Â  Â  Â  Â  Â  Â  Â  {% endif %}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card border-warning">
Â  Â  Â  Â  Â  Â  <div class="card-header bg-warning text-dark">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>3ï¸âƒ£ Pending Society Approvals ğŸ“</h4>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  {% if pending_approvals %}
Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-responsive-scroll">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="table table-striped table-hover table-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead class="thead-dark sticky-top">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Society</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Email / Mobile</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Max Voters</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Type</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Submitted</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Action</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {% for society in pending_approvals %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ society.society_name }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ society.email }} / {{ society.mobile_number }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ society.max_voters }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ society.housing_type }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ society.responded_at.strftime('%Y-%m-%d %H:%M') }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form method="POST" action="{{ url_for('approve_society', society_name=society.society_name) }}" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onsubmit="return confirm('Approve {{ society.society_name }}?');" style="display:inline;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-sm btn-primary">Approve</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form method="POST" action="{{ url_for('reject_society', society_name=society.society_name) }}" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onsubmit="return confirm('Reject {{ society.society_name }}?');" style="display:inline;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-sm btn-danger">Reject</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  {% else %}
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-muted">No pending societies awaiting approval.</p>
Â  Â  Â  Â  Â  Â  Â  Â  {% endif %}
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <div class="card master-erase-card border-danger">
Â  Â  Â  Â  Â  Â  <div class="card-header bg-danger text-white">
Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="mb-0"><i class="fas fa-radiation"></i> 5ï¸âƒ£ MASTER ERASE: Select Society to Erase (DANGER ZONE)</h4>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-danger font-weight-bold">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  âš ï¸ WARNING: This action is irreversible and will permanently delete ALL non-archived data for the selected society from the database.
Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  {% if societies %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group row">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="societySelector" class="col-md-5 col-form-label">Select Society to Erase:</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="col-md-7">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select class="form-control" id="societySelectorDropdown" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">-- Choose Society to Erase --</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {% for society_name in societies %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="{{ society_name }}">{{ society_name }}</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {% endfor %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="btn btn-lg btn-block btn-danger mt-3" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  id="eraseTriggerButton"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data-toggle="modal" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data-target="#eraseConfirmModal"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  disabled>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-trash-alt"></i> Initiate Permanent Erase
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  {% else %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="mb-0 text-secondary">No approved societies currently in the active database.</p>
Â  Â  Â  Â  Â  Â  Â  Â  {% endif %}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card border-info">
Â  Â  Â  Â  Â  Â  <div class="card-header bg-info text-white">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>4ï¸âƒ£ Active/Unused Invitation Links âœ‰ï¸</h4>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  {% if active_invites %}
Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-responsive-scroll">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="table table-striped table-hover table-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead class="thead-light sticky-top">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Placeholder</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Email</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Invited</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Expires</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Link (Click to Copy)</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {% for invite in active_invites %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ invite.society_name }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ invite.email }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ invite.invited_at.strftime('%Y-%m-%d') }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ invite.invite_end_at.strftime('%Y-%m-%d') }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-control form-control-sm invite-link-input" readonly
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  value="{{ base_url }}{{ invite.invite_token }}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="text-muted">Token: {{ invite.invite_token[:8] }}...</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {% endfor %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  {% else %}
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-muted">No active invitations. Generate a new one above!</p>
Â  Â  Â  Â  Â  Â  Â  Â  {% endif %}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  {% endif %}

Â  Â  Â  Â  <div class="modal fade" id="eraseConfirmModal" tabindex="-1" role="dialog" aria-labelledby="eraseConfirmModalLabel" aria-hidden="true">
Â  Â  Â  Â  Â  Â  <div class="modal-dialog" role="document">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-content border-danger">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-header bg-danger text-white">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h5 class="modal-title" id="eraseConfirmModalLabel"><i class="fas fa-skull-crossbones"></i> Confirm Permanent Data Deletion</h5>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span aria-hidden="true">&times;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-body">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-large">You are about to permanently delete **ALL** non-archived data for society: <strong id="societyNamePlaceholder" class="text-danger"></strong>.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-danger font-weight-bold">THIS ACTION IS IRREVERSIBLE AND CANNOT BE UNDONE.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Please type the society name (in uppercase) below to confirm this action:</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="societyNameConfirmation" class="form-control mb-3" placeholder="Type society name (e.g., SRGF)">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="eraseForm" method="POST" action="{{ url_for('erase_society') }}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="hidden" name="society_name" id="hiddenSocietyName">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" id="finalEraseButton" class="btn btn-danger btn-block" disabled>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-bomb"></i> PERMANENTLY ERASE DATA
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-footer">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel & Abort</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  </div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {

Â  Â  /* -------------------------------
Â  Â  Â  Â 1ï¸âƒ£ Copy Invitation Link Logic
Â  Â  --------------------------------*/
Â  Â  document.querySelectorAll('.invite-link-input').forEach(input => {
Â  Â  Â  Â  input.addEventListener('click', function() {
Â  Â  Â  Â  Â  Â  this.select();
Â  Â  Â  Â  Â  Â  document.execCommand('copy');
Â  Â  Â  Â  Â  Â  const original = this.value;
Â  Â  Â  Â  Â  Â  this.value = 'âœ… Link Copied!';
Â  Â  Â  Â  Â  Â  this.classList.add('copy-success');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  this.value = original;
Â  Â  Â  Â  Â  Â  Â  Â  this.classList.remove('copy-success');
Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  });
Â  Â  });

Â  Â  /* -------------------------------
Â  Â  Â  Â 2ï¸âƒ£ Master Erase Modal Logic
Â  Â  --------------------------------*/
Â  Â  const societySelectorDropdown = document.getElementById('societySelectorDropdown');
Â  Â  const eraseTriggerButton = document.getElementById('eraseTriggerButton');
Â  Â  const societyNameConfirmationInput = document.getElementById('societyNameConfirmation');
Â  Â  const finalEraseButton = document.getElementById('finalEraseButton');
Â  Â  const hiddenSocietyNameInput = document.getElementById('hiddenSocietyName');
Â  Â  const societyNamePlaceholder = document.getElementById('societyNamePlaceholder');

Â  Â  // Enable trigger button based on dropdown selection
Â  Â  if (societySelectorDropdown && eraseTriggerButton) {
Â  Â  Â  Â  societySelectorDropdown.addEventListener('change', function() {
Â  Â  Â  Â  Â  Â  eraseTriggerButton.disabled = !this.value;
Â  Â  Â  Â  });
Â  Â  }
Â 
Â  Â  // Setup modal before showing
Â  Â  $('#eraseConfirmModal').on('show.bs.modal', function () {
Â  Â  Â  Â  const selectedSociety = societySelectorDropdown ? societySelectorDropdown.value : '';
Â  Â  Â  Â  societyNameConfirmationInput.value = ''; 
Â  Â  Â  Â  finalEraseButton.disabled = true; 
Â  Â  Â  Â  societyNamePlaceholder.textContent = selectedSociety;
Â  Â  Â  Â  hiddenSocietyNameInput.value = selectedSociety;
Â  Â  });

Â  Â  // Enable erase button when names match
Â  Â  if (societyNameConfirmationInput) {
Â  Â  Â  Â  societyNameConfirmationInput.addEventListener('input', function() {
Â  Â  Â  Â  Â  Â  this.value = this.value.toUpperCase();
Â  Â  Â  Â  Â  Â  const societyName = hiddenSocietyNameInput.value;
Â  Â  Â  Â  Â  Â  finalEraseButton.disabled = (this.value !== societyName);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  /* -------------------------------
Â  Â  Â  Â 3ï¸âƒ£ Tooltip + Right-Click Disable (RETAINED)
Â  Â  --------------------------------*/
Â  Â  $('[data-toggle="tooltip"]').tooltip();

Â  Â  document.addEventListener('contextmenu', function(e) {
Â  Â  Â  Â  e.preventDefault();
Â  Â  });

Â  Â  /* -------------------------------
Â  Â  Â  Â 4ï¸âƒ£ Prevent Browser Back After Logout (RETAINED)
Â  Â  --------------------------------*/
Â  Â  if (window.history && window.history.pushState) {
Â  Â  Â  Â  window.history.pushState(null, null, window.location.href);
Â  Â  Â  Â  window.onpopstate = function () {
Â  Â  Â  Â  Â  Â  window.history.go(1);
Â  Â  Â  Â  };
Â  Â  }

});
</script>

Â  Â  <footer class="fixed-bottom text-center text-muted" style="font-size: 1rem; padding: 10px; background-color: #f4f7f6; z-index: 1000;">
Â  Â  Â  Â  D3 by: 
Â  Â  Â  Â  <a href="mailto:siva.admn25@gmail.com" style="color: #0000FF; text-decoration: underline;" class="hover:text-blue-700">
Â  Â  Â  Â  Â  Â  siva.admn25@gmail.com
Â  Â  Â  Â  </a>
Â  Â  </footer>

</body>
</html>